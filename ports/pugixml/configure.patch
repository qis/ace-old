--- i/src/pugiconfig.hpp
+++ w/src/pugiconfig.hpp
@@ -21,7 +21,7 @@
 // #define PUGIXML_COMPACT
 
 // Uncomment this to disable XPath
-// #define PUGIXML_NO_XPATH
+#define PUGIXML_NO_XPATH
 
 // Uncomment this to disable STL
 // #define PUGIXML_NO_STL
@@ -34,6 +34,21 @@
 // #define PUGIXML_CLASS __declspec(dllimport) // to import all classes from DLL
 // #define PUGIXML_FUNCTION __fastcall // to set calling conventions to all public functions to fastcall
 // In absence of PUGIXML_CLASS/PUGIXML_FUNCTION definitions PUGIXML_API is used instead
+#ifdef ACE_SHARED
+#  ifdef _WIN32
+#    ifdef PUGIXML_EXPORT
+#      define PUGIXML_API __declspec(dllexport)
+#    else
+#      define PUGIXML_API __declspec(dllimport)
+#    endif
+#  else
+#    ifdef PUGIXML_EXPORT
+#      define PUGIXML_API __attribute__((visibility("default")))
+#    else
+#      define PUGIXML_API
+#    endif
+#  endif
+#endif
 
 // Tune these constants to adjust memory-related behavior
 // #define PUGIXML_MEMORY_PAGE_SIZE 32768
@@ -44,7 +59,7 @@
 // #define PUGIXML_HEADER_ONLY
 
 // Uncomment this to enable long long support
-// #define PUGIXML_HAS_LONG_LONG
+#define PUGIXML_HAS_LONG_LONG
 
 #endif
 
